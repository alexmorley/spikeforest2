# Spike sorting a SpikeForest recording

A subset of the recordings featured on the SpikeForest website are available for
public download using our Python interface. Here we describe how to download and
perform spike sorting on one of these recordings.

After installation, the below code may be run via [this python file](spike_sorting_spikeforest_recording.py).

## Prerequisites

{% include 'j2templates/prerequisites.md' %}

## Installation

{% include 'j2templates/install_spikeforest_pypi.md' %}

## Downloading a recording

To download a SpikeForest recording, you will first need to know its `sha1dir://` URI. Presently there
is no method for obtaining this via the website, although we will provide this feature in an upcoming
release. However, we provide some test examples here.

Making use of [SpikeInterface](https://github.com/SpikeInterface/), we can load the recording and the ground truth sorting in Python:

```python
{% include 'j2templates/load_spikeforest_tetrode_recording.py' %}
```

This will automatically download the necessary files and you now have objects
representing the recording and ground truth sorting which you can manipulate
using the tools of [SpikeInterface](https://github.com/SpikeInterface/).

## Running the sorting

For our purposes, we will operate directly on the recording directory in order
to take advantage of the MountainTools caching and container capabilities. But
in the future we will be able to perform these operations directly using the
extractor objects.

```python
{% include 'j2templates/run_spike_sorting.py' %}
```

{% include 'j2templates/explain_force_run.md' %}

As mentioned in the comments above, you can use any of the SpikeForest-wrapped
sorting algorithms in place of MountainSort4.

## Comparison with ground truth

Next, we can compare the result with ground truth

```python
{% include 'j2templates/compare_with_truth.py' %}
```